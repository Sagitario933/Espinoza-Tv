<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Verificador de enlaces M3U8</title>
  <style>
    body {
      background: #181818;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 40px;
    }
    h2 {
      color: #ffd700;
    }
    textarea {
      width: 100%;
      height: 120px;
      border-radius: 6px;
      border: none;
      padding: 10px;
      font-size: 1em;
      background: #222;
      color: #fff;
      margin-bottom: 10px;
      resize: vertical;
    }
    button {
      padding: 10px 20px;
      background: #ffd700;
      color: #222;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      margin-bottom: 20px;
    }
    .result {
      margin-top: 20px;
    }
    .link-status {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
      padding: 8px;
      border-radius: 5px;
      background: #222;
    }
    .online {
      color: #00ff00;
      font-weight: bold;
    }
    .offline {
      color: #ff4444;
      font-weight: bold;
    }
    .url {
      word-break: break-all;
      color: #ffd700;
    }
  </style>
</head>
<body>
  <div style="display: flex; justify-content: space-between; align-items: flex-start;">
    <h2 style="margin: 0;">Verificador de enlaces M3U8</h2>
    <div style="color: #ff4444; font-weight: bold; font-size: 1.1em; text-align: right;">Enlaces OFFLINE - CORS<br><span style="font-size: 0.9em; font-weight: normal; color: #fff;">Los canales OFFLINE pueden ser privados o tener restricciones de acceso.</span></div>
  </div>
  <textarea id="m3u8list" placeholder="Pega aquí los enlaces .m3u8, uno por línea..."></textarea>
  <br>
  <button onclick="verificarEnlaces()">Verificar</button>
  <button onclick="descargarCanalesOnline()">Descargar canales ONLINE</button>
  <div class="result" id="result"></div>

  <script>
    async function verificarEnlaces() {
      const lista = document.getElementById('m3u8list').value.trim().split(/\n+/);
      const result = document.getElementById('result');
      result.innerHTML = '';
      for (const url of lista) {
        if (!url) continue;
        const div = document.createElement('div');
        div.className = 'link-status';
        div.innerHTML = `<span class="url">${url}</span> <span>Verificando...</span>`;
        result.appendChild(div);
        try {
          const response = await fetch(url, { method: 'GET' });
          if (response.ok) {
            div.children[1].textContent = 'ONLINE';
            div.children[1].className = 'online';
          } else {
            div.children[1].textContent = 'OFFLINE';
            div.children[1].className = 'offline';
          }
        } catch (e) {
          div.children[1].textContent = 'OFFLINE';
          div.children[1].className = 'offline';
        }
      }
    }

    function descargarCanalesOnline() {
      const result = document.getElementById('result');
      let canales = [];
      Array.from(result.children).forEach(div => {
        const status = div.querySelector('.online');
        if (status) {
          const url = div.querySelector('.url').textContent;
          canales.push(url);
        }
      });
      if (canales.length === 0) {
        alert('No hay canales ONLINE para descargar.');
        return;
      }
      const blob = new Blob([canales.join('\n')], { type: 'text/plain' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'canales_online.txt';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>
</body>
</html>
